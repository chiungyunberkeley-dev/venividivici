<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>凱薩GLORY - 官方網站</title>
    <style>
        /* --- 全局變數與設定 --- */
        :root {
            --bg-color: #262626;
            --text-color: #ddd;
            --accent-gold: #d4af37;
            --tag-active: #ffcc00;
            --theme-blue: #00bfff;
            --theme-green: #9acd32;
            --theme-purple: #a020f0;
            --theme-red: #ff4500;
            --theme-black: #bbb; /* 銀灰色代表黑 */
            --theme-yellow: #ffcc00;
        }
        body { margin: 0; padding: 0; background-color: var(--bg-color); font-family: "Microsoft JhengHei", "Heiti TC", sans-serif; color: var(--text-color); box-sizing: border-box; }
        a { text-decoration: none; color: inherit; cursor: pointer; }
        ul { list-style: none; padding: 0; margin: 0; }
        * { box-sizing: border-box; }

        /* --- 導航欄 --- */
        header { display: flex; justify-content: space-between; align-items: center; padding: 20px 40px; border-bottom: 1px solid #333; background: #1a1a1a; position: sticky; top: 0; z-index: 1000; }
        .logo { font-size: 26px; font-weight: bold; color: var(--accent-gold); display: flex; align-items: center; }
        .logo span { margin-right: 5px; font-family: serif; font-size: 30px; }
        nav ul { display: flex; gap: 30px; }
        nav ul li a { font-size: 16px; color: #ccc; transition: 0.3s; }
        nav ul li a:hover, nav ul li a.active { color: #ff7f50; border-bottom: 2px solid #ff7f50; padding-bottom: 5px; }
        .login-btn { border: 1px solid #555; padding: 5px 15px; border-radius: 4px; font-size: 12px; color: #888; }

        /* --- 頁面切換 --- */
        .page-section { display: none; padding: 40px 20px; max-width: 1100px; margin: 0 auto; animation: fadeIn 0.5s; }
        .page-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* --- 首頁 --- */
        .hero-carousel { width: 100%; height: 500px; background: #000; position: relative; overflow: hidden; margin-bottom: 40px; border-bottom: 1px solid #444; }
        .carousel-slide { width: 100%; height: 100%; position: absolute; opacity: 0; transition: opacity 1s ease-in-out; background-size: cover; background-position: center; display: flex; align-items: flex-end; justify-content: center; }
        .carousel-slide.active { opacity: 1; }
        .carousel-caption { background: linear-gradient(to top, rgba(0,0,0,0.9), transparent); padding: 40px 20px; color: #fff; width: 100%; text-align: center; font-size: 28px; text-shadow: 0 2px 4px rgba(0,0,0,0.8); }
        
        .news-section { background: #333; padding: 30px; border-left: 5px solid var(--accent-gold); margin-top: 20px; border-radius: 0 10px 10px 0; }
        .news-title { color: var(--accent-gold); font-size: 24px; margin-bottom: 15px; border-bottom: 1px dashed #555; padding-bottom: 10px; font-family: serif; }
        .news-content p { margin: 10px 0; color: #eee; font-size: 16px; line-height: 1.6; }

        /* --- 書籍目錄 --- */
        .category-icons { display: flex; justify-content: center; gap: 20px; margin-bottom: 40px; flex-wrap: wrap; }
        .icon-item { display: flex; flex-direction: column; align-items: center; cursor: pointer; transition: transform 0.2s; }
        .icon-item:hover { transform: translateY(-5px); }
        .circle { width: 55px; height: 55px; border-radius: 50%; border: 2px solid; display: flex; justify-content: center; align-items: center; font-size: 24px; font-weight: bold; font-family: serif; margin-bottom: 8px; }
        .icon-label { font-size: 13px; color: #aaa; letter-spacing: 1px; }
        
        /* 顏色定義 */
        .c-yellow { border-color: var(--theme-yellow); color: var(--theme-yellow); }
        .c-black { border-color: var(--theme-black); color: var(--theme-black); }
        .c-purple { border-color: var(--theme-purple); color: var(--theme-purple); }
        .c-blue { border-color: var(--theme-blue); color: var(--theme-blue); }
        .c-red { border-color: var(--theme-red); color: var(--theme-red); }
        .c-green { border-color: var(--theme-green); color: var(--theme-green); }

        .tags-section { margin-bottom: 40px; }
        .tag-label { color: #ff7f50; font-size: 16px; margin-right: 15px; font-family: serif; display: inline-block;}
        .tag-list { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px; }
        .tag-btn { background: transparent; border: 1px solid #ff7f50; color: #ff7f50; padding: 4px 15px; border-radius: 6px; cursor: pointer; transition: 0.3s; font-size: 13px; }
        .tag-btn:hover { background: rgba(255, 127, 80, 0.1); }
        /* Active Tag: 黃色字 + 黃色框 + 空心 */
        .tag-btn.active { background: transparent; color: var(--tag-active); border-color: var(--tag-active); }
        .break { flex-basis: 100%; height: 0; }

        /* 書籍卡片 */
        .book-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(480px, 1fr)); gap: 50px; }
        .book-card { display: flex; flex-direction: column; padding-bottom: 25px; border-bottom: 1px solid transparent; }
        
        /* 動態顏色邊框 */
        .theme-blue { border-bottom-color: var(--theme-blue); } .theme-blue .t-color { color: var(--theme-blue); border-color: var(--theme-blue); }
        .theme-green { border-bottom-color: var(--theme-green); } .theme-green .t-color { color: var(--theme-green); border-color: var(--theme-green); }
        .theme-purple { border-bottom-color: var(--theme-purple); } .theme-purple .t-color { color: var(--theme-purple); border-color: var(--theme-purple); }
        .theme-red { border-bottom-color: var(--theme-red); } .theme-red .t-color { color: var(--theme-red); border-color: var(--theme-red); }
        .theme-black { border-bottom-color: var(--theme-black); } .theme-black .t-color { color: var(--theme-black); border-color: var(--theme-black); }
        .theme-yellow { border-bottom-color: var(--theme-yellow); } .theme-yellow .t-color { color: var(--theme-yellow); border-color: var(--theme-yellow); }

        .book-header { display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 5px; }
        .book-icon { border: 1px solid; border-radius: 50%; width: 24px; height: 24px; display: inline-flex; justify-content: center; align-items: center; margin-right: 5px; font-size: 14px; flex-shrink: 0; }
        .book-title { font-size: 20px; }
        .book-price { color: #fff; font-size: 16px; }
        .divider { border-top: 1px dotted; margin: 10px 0; opacity: 0.7; }
        .book-meta { font-size: 12px; margin-bottom: 15px; line-height: 1.4; }
        .book-content { display: flex; gap: 20px; margin-bottom: 15px; }
        .book-cover { width: 140px; height: 200px; background: #444; object-fit: cover; flex-shrink: 0; }
        .book-desc { font-size: 14px; line-height: 1.6; color: #ccc; text-align: justify; }
        .quote { display: block; margin-bottom: 10px; color: #fff; font-weight: bold; }
        .author-name { color: #888; font-size: 13px; margin-bottom: 15px; padding-left: 2px; }
        
        .action-buttons { display: flex; gap: 15px; margin-top: auto; }
        .btn { flex: 1; padding: 10px 0; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; text-align: center; transition: opacity 0.3s; font-size: 15px; }
        .btn:hover { opacity: 0.8; }
        .btn-buy { background: #fa8072; color: #fff; }
        .btn-info { background: #f4d03f; color: #333; }

        /* --- 作者頁 --- */
        .author-container { display: grid; grid-template-columns: 1fr 1fr; gap: 60px; }
        .author-column { background: #2a2a2a; padding: 30px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
        .author-header { text-align: center; margin-bottom: 30px; border-bottom: 1px solid #444; padding-bottom: 20px; }
        .author-avatar { width: 140px; height: 140px; border-radius: 50%; border: 3px solid var(--accent-gold); object-fit: cover; margin-bottom: 15px; background: #ddd;}
        .author-name-title { font-size: 24px; color: var(--accent-gold); margin-bottom: 15px; font-weight: bold; }
        .author-bio { font-size: 14px; color: #ccc; text-align: left; line-height: 1.8; white-space: pre-line; }
        
        .work-section { margin-bottom: 30px; }
        .section-title { font-size: 16px; color: #ff7f50; border-left: 4px solid #ff7f50; padding-left: 10px; margin-bottom: 15px; font-weight: bold; letter-spacing: 1px; }
        .work-list li { margin-bottom: 10px; font-size: 15px; display: flex; justify-content: space-between; border-bottom: 1px solid #333; padding-bottom: 5px; }
        .work-title { color: #eee; }
        .work-tags { font-size: 12px; color: #888; margin-left: 10px; }

        /* --- 後台 --- */
        .login-box { max-width: 400px; margin: 100px auto; background: #333; padding: 40px; text-align: center; border-radius: 8px; }
        .admin-panel { display: none; }
        .admin-panel.active { display: block; }
        .form-group { margin-bottom: 15px; text-align: left; }
        .form-group label { display: block; margin-bottom: 5px; color: var(--accent-gold); font-size: 14px; }
        .form-control { width: 100%; padding: 10px; background: #444; border: 1px solid #555; color: #fff; border-radius: 4px; font-size: 14px; }
        .btn-submit { background: var(--theme-blue); color: white; width: 100%; padding: 12px; font-size: 16px; margin-top: 20px; cursor: pointer; border: none; border-radius: 4px; }
        .btn-small { padding: 4px 8px; font-size: 12px; margin-left: 5px; cursor: pointer; border-radius: 3px; border: none; }
        
        /* Mobile */
        @media (max-width: 768px) {
            header { flex-direction: column; gap: 15px; padding: 15px; }
            .book-grid { grid-template-columns: 1fr; }
            .author-container { grid-template-columns: 1fr; }
            .hero-carousel { height: 300px; }
            .category-icons .icon-item { transform: scale(0.9); }
        }
    </style>
</head>
<body>

    <header>
        <div class="logo"><span>⚜</span> 凱薩GLORY</div>
        <nav>
            <ul>
                <li><a onclick="route('home')" id="nav-home" class="active">Home</a></li>
                <li><a onclick="route('books')" id="nav-books">Books</a></li>
                <li><a onclick="route('author')" id="nav-author">About</a></li>
                <li><a onclick="route('admin')" id="nav-admin" class="login-btn">後台管理</a></li>
            </ul>
        </nav>
    </header>

    <div id="home" class="page-section active">
        <div class="hero-carousel" id="homeCarousel">
            </div>

        <div class="news-section">
            <h2 class="news-title">NEW PUBLICATION - 最新出版資訊</h2>
            <div class="news-content" id="homeNews">
                </div>
        </div>
    </div>

    <div id="books" class="page-section">
        <div class="category-icons">
            <div class="icon-item" onclick="filterByColor('theme-yellow')"><div class="circle c-yellow">寰</div><span class="icon-label">綜合其他</span></div>
            <div class="icon-item" onclick="filterByColor('theme-black')"><div class="circle c-black">諱</div><span class="icon-label">黑色驚悚</span></div>
            <div class="icon-item" onclick="filterByColor('theme-purple')"><div class="circle c-purple">異</div><span class="icon-label">架空背景</span></div>
            <div class="icon-item" onclick="filterByColor('theme-blue')"><div class="circle c-blue">職</div><span class="icon-label">現代都市</span></div>
            <div class="icon-item" onclick="filterByColor('theme-red')"><div class="circle c-red">鑑</div><span class="icon-label">推理軍情</span></div>
            <div class="icon-item" onclick="filterByColor('theme-green')"><div class="circle c-green">誌</div><span class="icon-label">羅馬假期</span></div>
        </div>

        <div class="tags-section">
            <div class="tag-label">TAG:</div>
            <div class="tag-list" id="tagListContainer">
                </div>
        </div>

        <div class="book-grid" id="bookCatalog">
            </div>
    </div>

    <div id="author" class="page-section">
        <div class="author-container">
            <div class="author-column">
                <div class="author-header">
                    <img src="https://via.placeholder.com/150/444444/ffffff?text=Moscato" class="author-avatar">
                    <div class="author-name-title">◆ 莫斯卡托 ◆</div>
                    <div class="author-bio">暱稱酒杯。
平常在浪浪走跳玩耍，主要寫耽美，喜歡刑偵、喜歡歐美背景、也喜歡強強和弱強！
FC2收錄文最完整。</div>
                </div>
                <div id="list-moscato"></div>
            </div>

            <div class="author-column">
                <div class="author-header">
                    <img src="https://via.placeholder.com/150/444444/ffffff?text=Bunsen" class="author-avatar">
                    <div class="author-name-title">◆ 本生燈 ◆</div>
                    <div class="author-bio">住在本生燈的許願精靈，暱稱生生。
喜歡解謎，主要寫耽美與懸疑小說，偶爾寫一般向！
文章首更於CxC，歡迎訂閱！</div>
                </div>
                <div id="list-bunsen"></div>
            </div>
        </div>
    </div>

    <div id="admin" class="page-section">
        <div id="loginForm" class="login-box">
            <h2 style="color: var(--accent-gold);">後台登入</h2>
            <p style="color: #888; font-size: 12px;">(預設密碼: 1234)</p>
            <div class="form-group">
                <input type="password" id="adminPwd" class="form-control" placeholder="請輸入密碼">
            </div>
            <button class="btn btn-submit" onclick="login()">登入</button>
        </div>

        <div id="adminPanel" class="admin-panel">
            <div style="display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid var(--accent-gold); padding-bottom: 10px; margin-bottom: 20px;">
                <h2 style="margin:0;">書籍資料管理系統</h2>
                <button class="btn-small" style="background:#555; color:#fff;" onclick="logout()">登出</button>
            </div>
            
            <div style="display: grid; grid-template-columns: 4fr 6fr; gap: 30px;">
                <div style="background: #222; padding: 20px; border-radius: 8px;">
                    <h3 style="color: var(--theme-blue); margin-top: 0;">新增 / 編輯書籍</h3>
                    <input type="hidden" id="editId">
                    
                    <div class="form-group">
                        <label>書名</label>
                        <input type="text" id="inTitle" class="form-control">
                    </div>
                    
                    <div style="display: flex; gap: 10px;">
                        <div class="form-group" style="flex:1;">
                            <label>作者</label>
                            <select id="inAuthor" class="form-control">
                                <option value="本生燈">本生燈</option>
                                <option value="莫斯卡托">莫斯卡托</option>
                                <option value="莫斯卡托、本生燈">合著</option>
                            </select>
                        </div>
                        <div class="form-group" style="flex:1;">
                            <label>作品狀態</label>
                            <select id="inStatus" class="form-control" onchange="togglePubFields()">
                                <option value="ongoing">連載中</option>
                                <option value="completed">已完結</option>
                                <option value="published">已出版</option>
                            </select>
                        </div>
                    </div>

                    <div id="pubFields" style="display:none; background: #333; padding: 15px; border-radius: 5px; margin-bottom: 15px; border: 1px solid var(--theme-green);">
                        <label style="color: var(--theme-green); font-weight: bold; border-bottom: 1px solid var(--theme-green); display: inline-block; margin-bottom: 10px;">出版資訊設定</label>
                        <div style="display: flex; gap: 10px;">
                            <div class="form-group" style="flex:1;">
                                <label>定價</label>
                                <input type="number" id="inPrice" class="form-control" placeholder="350">
                            </div>
                            <div class="form-group" style="flex:1;">
                                <label>分類顏色</label>
                                <select id="inColor" class="form-control">
                                    <option value="theme-blue">藍色 (現代都市)</option>
                                    <option value="theme-green">綠色 (羅馬假期)</option>
                                    <option value="theme-purple">紫色 (架空背景)</option>
                                    <option value="theme-red">紅色 (推理軍情)</option>
                                    <option value="theme-black">黑色 (黑色驚悚)</option>
                                    <option value="theme-yellow">黃色 (綜合其他)</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>購買連結</label>
                            <input type="text" id="inBuy" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>資訊頁連結</label>
                            <input type="text" id="inInfo" class="form-control">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Tags (請用逗號分隔)</label>
                        <input type="text" id="inTags" class="form-control" placeholder="例如: 耽美, 強強, 甜寵">
                    </div>

                    <div class="form-group">
                        <label>封面圖片網址</label>
                        <input type="text" id="inCover" class="form-control" placeholder="https://...">
                    </div>

                    <div class="form-group">
                        <label>文案內容</label>
                        <textarea id="inDesc" class="form-control" rows="5"></textarea>
                    </div>

                    <div style="background: #2a2a2a; padding: 10px; border-radius: 5px;">
                        <label style="display: inline-flex; align-items: center; color: #fff; cursor: pointer;">
                            <input type="checkbox" id="inCarousel" style="margin-right: 8px;"> 加入首頁輪播 (僅出版作品有效)
                        </label>
                        <br><br>
                        <label>更新首頁跑馬燈</label>
                        <input type="text" id="inNews" class="form-control" placeholder="輸入文字後儲存即更新首頁公告">
                    </div>

                    <div style="display: flex; gap: 10px; margin-top: 20px;">
                        <button class="btn-submit" onclick="saveBook()">儲存資料</button>
                        <button class="btn-submit" style="background: #555;" onclick="resetForm()">重置</button>
                    </div>
                </div>

                <div>
                    <h3 style="color: #aaa; margin-top: 0;">現有書籍列表 (共 <span id="bookCount">0</span> 本)</h3>
                    <div style="max-height: 800px; overflow-y: auto;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 14px;">
                            <thead>
                                <tr style="background: #333; color: var(--accent-gold);">
                                    <th style="padding: 10px; text-align: left;">ID</th>
                                    <th style="padding: 10px; text-align: left;">書名</th>
                                    <th style="padding: 10px; text-align: left;">狀態</th>
                                    <th style="padding: 10px; text-align: right;">操作</th>
                                </tr>
                            </thead>
                            <tbody id="adminList">
                                </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- 1. 資料初始化 ---
        // 預載 17 本書的資料 (依照您的要求)
        const initialBooks = [
            { id: 17, title: "安邦立業先守成 上", author: "本生燈", status: "published", category: "theme-blue", price: 350, tags: "現代都市, 耽美, 雙向暗戀, 甜寵, 本生燈", cover: "https://via.placeholder.com/140x200/223344?text=AnBang+1", desc: "「只要你敢要，那就有。」<br>陳守安在泳池進了一間傳說中供Gay打砲的淋浴間，和猛男來一場酣暢淋漓的豔遇...<br>一個是剛踏入社會的菜鳥工程師，一個是在社會打滾多年的企業董事長...", carousel: true, buyLink: "#", infoLink: "#" },
            { id: 16, title: "安邦立業先守成 下", author: "本生燈", status: "published", category: "theme-blue", price: 350, tags: "現代都市, 耽美, 雙向暗戀, 甜寵, 本生燈", cover: "https://via.placeholder.com/140x200/223344?text=AnBang+2", desc: "「喜歡嗎？我認為這兩個字還不夠...」<br>隨著兩人的感情漸入佳境，價值觀與社經地位的差異也逐漸浮現出來...<br>但人生哪能不起波折，只求有緣人同舟共渡。", carousel: true, buyLink: "#", infoLink: "#" },
            { id: 15, title: "003期 Wedding", author: "莫斯卡托、本生燈", status: "published", category: "theme-green", price: 240, tags: "耽美, 現代都市, 甜寵, 莫斯卡托", cover: "https://via.placeholder.com/140x200/224422?text=Wedding", desc: "收錄《性，愛與筆記》及《當星星殞落》相關番外<br>《性，愛與筆記》番外收錄：千年結緣、浪漫脈動<br>《當星星殞落》番外收錄：浪漫脈動、一加一", carousel: false, buyLink: "#", infoLink: "#" },
            { id: 14, title: "錄音間秘事", author: "本生燈", status: "published", category: "theme-blue", price: 250, tags: "現代都市, 耽美, 雙向暗戀, 甜寵, 本生燈", cover: "https://via.placeholder.com/140x200/334455?text=Recording", desc: "「我們在一起之後，我每天都在感謝老天爺...」<br>程曉璐第一次接演耽美廣播劇，與前輩姚謹懷搭戲，他被姚謹懷的呻吟勾起反應...", carousel: false, buyLink: "#", infoLink: "#" },
            { id: 13, title: "002期 LIFE", author: "莫斯卡托、本生燈", status: "published", category: "theme-green", price: 240, tags: "現代都市, 耽美, 番外, 莫斯卡托", cover: "https://via.placeholder.com/140x200/224422?text=LIFE", desc: "收錄《投資一定有風險》及《談愛傷感情》相關番外。", carousel: false, buyLink: "#", infoLink: "#" },
            { id: 12, title: "絕交進行式", author: "莫斯卡托", status: "published", category: "theme-blue", price: 200, tags: "現代都市, 耽美, 雙向暗戀, 甜寵, 莫斯卡托", cover: "https://via.placeholder.com/140x200/223344?text=Friendship", desc: "「我不缺朋友，也不缺室友，只缺男朋友。」<br>在外人眼中，陳鳴予是幽默多金的眼科醫師...<br>──我不想再和你當朋友，我們絕交吧！", carousel: false, buyLink: "#", infoLink: "#" },
            { id: 11, title: "騂驢之末", author: "本生燈", status: "published", category: "theme-black", price: 270, tags: "星際, ABO, 骨科, 人外, 兄弟, 年下, 懸疑, 異世界, 本生燈", cover: "https://via.placeholder.com/140x200/111111?text=Alien", desc: "【異世界懸疑耽美ABO短篇合集】<br>《騂艣之末》跨越星際、物種和血緣的複雜感情...<br>《深水里的叛徒》異色懸疑耽美...", carousel: false, buyLink: "#", infoLink: "#" },
            { id: 10, title: "北之國-冒險版", author: "莫斯卡托", status: "published", category: "theme-purple", price: 280, tags: "耽美, 奇幻架空, 雙性生子, 甜寵, 莫斯卡托", cover: "https://via.placeholder.com/140x200/442244?text=North+Adv", desc: "「只有你，有資格成為我孩子的父親。」<br>北之國王室的血脈特殊，他們沒有王后...<br>現任王儲‧諾恩年方十八，暗戀年長的家庭教師已久...", carousel: false, buyLink: "#", infoLink: "#" },
            { id: 9, title: "北之國-童話版", author: "莫斯卡托", status: "published", category: "theme-purple", price: 280, tags: "耽美, 奇幻架空, 雙性生子, 甜寵, 莫斯卡托", cover: "https://via.placeholder.com/140x200/442244?text=North+Fairy", desc: "「只有你，有資格成為我孩子的父親。」<br>內容同冒險版，但為不同封面版本。", carousel: false, buyLink: "#", infoLink: "#" },
            { id: 8, title: "當星星殞落", author: "莫斯卡托", status: "published", category: "theme-blue", price: 370, tags: "耽美, 現代都市, 暗戀, 強強, 莫斯卡托", cover: "https://via.placeholder.com/140x200/223344?text=Star", desc: "倘若神真的存在，我必然因為無數次祈求星星的殞落而被降罪。<br>「鬧夠了吧？盧學淵，你放開我！」<br>一場非預期的官司，讓盧學淵有了最好的理由再去摘取...", carousel: false, buyLink: "#", infoLink: "#" },
            { id: 7, title: "創刊號 GLORY", author: "莫斯卡托、本生燈", status: "published", category: "theme-green", price: 240, tags: "耽美, 現代都市, 演藝圈, 甜寵", cover: "https://via.placeholder.com/140x200/224422?text=GLORY", desc: "收錄《性，愛與筆記》及《當星星殞落》相關番外。", carousel: false, buyLink: "#", infoLink: "#" },
            { id: 6, title: "性，愛與筆記 · 微糖", author: "本生燈", status: "published", category: "theme-blue", price: 1100, tags: "耽美, 演藝圈, 現代都市, 本生燈", cover: "https://via.placeholder.com/140x200/223344?text=SexLove+1", desc: "他們之間，相隔兩億五千萬光年的距離。<br>當紅男星陸臣為了磨練自己的演技，接演一部同志片...", carousel: false, buyLink: "#", infoLink: "#" },
            { id: 5, title: "性，愛與筆記 · 半糖", author: "本生燈", status: "published", category: "theme-blue", price: "套書", tags: "耽美, 演藝圈, 現代都市, 本生燈", cover: "https://via.placeholder.com/140x200/223344?text=SexLove+2", desc: "「你穿這樣，很干擾我。」<br>陸臣為了避風頭，隨靳明毅出國參加研討會...", carousel: false, buyLink: "#", infoLink: "#" },
            { id: 4, title: "性，愛與筆記 · 全糖", author: "本生燈", status: "published", category: "theme-blue", price: "套書", tags: "耽美, 演藝圈, 現代都市, 本生燈", cover: "https://via.placeholder.com/140x200/223344?text=SexLove+3", desc: "「你的喜歡很珍貴，值得我每天向你討。」<br>靳明毅與陸臣終於確定關係，幸福只差臨門一腳...", carousel: false, buyLink: "#", infoLink: "#" },
            { id: 3, title: "SCID-異鄉人 上冊", author: "莫斯卡托", status: "published", category: "theme-red", price: 320, tags: "耽美, 軍警, 懸疑推理, 現代都市, 歐美風, 強強, 莫斯卡托", cover: "https://via.placeholder.com/140x200/552222?text=SCID+1", desc: "「別說戀人，他們連朋友都當不成！」<br>特殊犯罪搜查組迎來新任檢察官，布蘭登‧伊茲...", carousel: false, buyLink: "#", infoLink: "#" },
            { id: 2, title: "SCID-異鄉人 下冊", author: "莫斯卡托", status: "published", category: "theme-red", price: 380, tags: "耽美, 軍警, 懸疑推理, 現代都市, 歐美風, 強強, 莫斯卡托", cover: "https://via.placeholder.com/140x200/552222?text=SCID+2", desc: "當獵人與獵物的立場對換，該如何出擊？<br>獵豔被撞破，丹佐的行為直接踩上布蘭登的底線...", carousel: false, buyLink: "#", infoLink: "#" },
            { id: 1, title: "但凡死者都姓蘇", author: "本生燈", status: "published", category: "theme-purple", price: 200, tags: "一般向, 穿越, 懸疑推理, 現代都市, 強強, 本生燈", cover: "https://via.placeholder.com/140x200/442244?text=Su", desc: "「所以，沒有人有不在場證明嗎？」<br>蘇曉寒一覺醒來發現落入自己的遊戲...", carousel: false, buyLink: "#", infoLink: "#" },
            
            // 示範用的連載與完結作品 (模擬作者頁功能)
            { id: 101, title: "金色深淵", author: "莫斯卡托", status: "ongoing", tags: "耽美, 歐美, 懸疑", desc: "連載中...", cover: "", carousel: false },
            { id: 102, title: "非我族類，其心必異", author: "本生燈", status: "ongoing", tags: "耽美, ABO, 星際", desc: "連載中...", cover: "", carousel: false },
            { id: 103, title: "我們這裡有跳蚤", author: "莫斯卡托", status: "completed", tags: "耽美, 冷戰, 間諜", desc: "已完結短篇。", cover: "", carousel: false }
        ];

        // 讀取 LocalStorage 或使用預設
        let books = JSON.parse(localStorage.getItem('glory_books'));
        if (!books || books.length === 0) {
            books = initialBooks;
            localStorage.setItem('glory_books', JSON.stringify(books));
        }
        
        let newsText = localStorage.getItem('glory_news') || "▶ 2024 新書上市：《安邦立業先守成》上/下冊 熱賣中！";

        // 全局標籤按鈕定義 (對應截圖)
        const allTags = ["全部作品", "莫斯卡托", "本生燈", "耽美", "一般向", "穿越", "演藝圈", "軍警", "懸疑推理", "現代都市", "歐美風", "強強", "雙性生子", "奇幻架空", "星際", "骨科", "年下", "ABO", "人外"];

        // --- 2. 頁面控制 ---
        function route(pageId) {
            document.querySelectorAll('.page-section').forEach(el => el.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            
            document.querySelectorAll('nav a').forEach(el => el.classList.remove('active'));
            document.getElementById('nav-' + pageId).classList.add('active');

            if(pageId === 'home') renderHome();
            if(pageId === 'books') renderBooks();
            if(pageId === 'author') renderAuthor();
            if(pageId === 'admin') renderAdmin();
        }

        // --- 3. 渲染首頁 ---
        let carouselInterval;
        function renderHome() {
            document.getElementById('homeNews').innerHTML = `<p>${newsText}</p>`;
            
            const wrapper = document.getElementById('homeCarousel');
            wrapper.innerHTML = '';
            
            // 篩選：已出版 + 勾選輪播
            const slides = books.filter(b => b.status === 'published' && b.carousel).sort((a,b) => b.id - a.id);
            
            if(slides.length === 0) {
                wrapper.innerHTML = '<div style="display:flex;justify-content:center;align-items:center;height:100%;color:#555;">尚無輪播內容</div>';
                return;
            }

            slides.forEach((b, idx) => {
                const div = document.createElement('div');
                div.className = `carousel-slide ${idx === 0 ? 'active' : ''}`;
                const bg = b.cover || 'https://via.placeholder.com/800x400';
                div.style.backgroundImage = `url('${bg}')`;
                div.innerHTML = `<div class="carousel-caption">${b.title}</div>`;
                wrapper.appendChild(div);
            });

            // 輪播動畫
            clearInterval(carouselInterval);
            let current = 0;
            const els = document.querySelectorAll('.carousel-slide');
            if(els.length > 1) {
                carouselInterval = setInterval(() => {
                    els[current].classList.remove('active');
                    current = (current + 1) % els.length;
                    els[current].classList.add('active');
                }, 3500);
            }
        }

        // --- 4. 渲染書籍目錄 ---
        function renderBooks() {
            // 生成 Tag 按鈕
            const tagContainer = document.getElementById('tagListContainer');
            tagContainer.innerHTML = '';
            allTags.forEach(tag => {
                const btn = document.createElement('button');
                btn.className = `tag-btn ${tag === '全部作品' ? 'active' : ''}`;
                btn.innerText = tag;
                if(tag === '本生燈' || tag === '莫斯卡托' || tag === '全部作品') btn.classList.add('break'); // 簡單換行模擬
                btn.onclick = () => filterBooks('tag', tag, btn);
                tagContainer.appendChild(btn);
            });

            // 初始顯示所有已出版
            filterBooks('tag', '全部作品');
        }

        function filterBooks(type, value, btnElem) {
            // 處理按鈕樣式
            if(btnElem) {
                document.querySelectorAll('.tag-btn').forEach(b => b.classList.remove('active'));
                btnElem.classList.add('active');
            }

            const container = document.getElementById('bookCatalog');
            container.innerHTML = '';

            // 邏輯：只顯示 published，並依照 ID 降序 (新到舊)
            let list = books.filter(b => b.status === 'published').sort((a,b) => b.id - a.id);

            if (type === 'color') {
                list = list.filter(b => b.category === value);
            } else if (type === 'tag' && value !== '全部作品') {
                list = list.filter(b => b.tags.includes(value) || b.author.includes(value));
            }

            list.forEach(b => {
                let icon = "書";
                if(b.category.includes("blue")) icon = "職";
                if(b.category.includes("green")) icon = "誌";
                if(b.category.includes("red")) icon = "鑑";
                if(b.category.includes("purple")) icon = "異";
                if(b.category.includes("black")) icon = "諱";
                if(b.category.includes("yellow")) icon = "震";

                const card = `
                    <article class="book-card ${b.category}">
                        <div class="book-header">
                            <div><span class="book-icon t-color">${icon}</span> <span class="book-title t-color">${b.title}</span></div>
                            <span class="book-price">NTD.${b.price}元</span>
                        </div>
                        <div class="divider t-color"></div>
                        <div class="book-meta t-color">TAG：${b.tags}</div>
                        <div class="book-content">
                            <img src="${b.cover}" class="book-cover">
                            <div class="book-desc">${b.desc}</div>
                        </div>
                        <div class="author-name">${b.author}</div>
                        <div class="action-buttons">
                            <button class="btn btn-buy" onclick="window.open('${b.buyLink}')">購 買</button>
                            <button class="btn btn-info" onclick="window.open('${b.infoLink}')">資 訊 頁</button>
                        </div>
                    </article>
                `;
                container.innerHTML += card;
            });
        }
        
        // 為了讓 Icon 也能呼叫 filter
        function filterByColor(color) {
            // 重置所有 tag 按鈕
            document.querySelectorAll('.tag-btn').forEach(b => b.classList.remove('active'));
            filterBooks('color', color);
        }

        // --- 5. 渲染作者頁 ---
        function renderAuthor() {
            renderAuthorList('莫斯卡托', 'list-moscato');
            renderAuthorList('本生燈', 'list-bunsen');
        }

        function renderAuthorList(authorName, containerId) {
            const div = document.getElementById(containerId);
            div.innerHTML = '';

            // 找出該作者的書 (包含合著)
            const myBooks = books.filter(b => b.author.includes(authorName)).sort((a,b) => b.id - a.id);

            const ongoing = myBooks.filter(b => b.status === 'ongoing');
            const completed = myBooks.filter(b => b.status === 'completed');
            const published = myBooks.filter(b => b.status === 'published');

            const makeUl = (list) => {
                return list.map(b => `<li><span class="work-title">《${b.title}》</span><span class="work-tags">${b.tags.split(',')[0]}...</span></li>`).join('');
            };

            if(ongoing.length > 0) div.innerHTML += `<div class="work-section"><div class="section-title">【連載中作品】</div><ul class="work-list">${makeUl(ongoing)}</ul></div>`;
            if(completed.length > 0) div.innerHTML += `<div class="work-section"><div class="section-title">【完結作品】</div><ul class="work-list">${makeUl(completed)}</ul></div>`;
            if(published.length > 0) div.innerHTML += `<div class="work-section"><div class="section-title">【出版作品】</div><ul class="work-list">${makeUl(published)}</ul></div>`;
        }

        // --- 6. 後台功能 ---
        function login() {
            if(document.getElementById('adminPwd').value === '1234') {
                document.getElementById('loginForm').style.display = 'none';
                document.getElementById('adminPanel').classList.add('active');
                renderAdminList();
            } else {
                alert("密碼錯誤");
            }
        }
        function logout() {
            location.reload();
        }

        function togglePubFields() {
            const st = document.getElementById('inStatus').value;
            document.getElementById('pubFields').style.display = (st === 'published') ? 'block' : 'none';
        }

        function renderAdminList() {
            const tbody = document.getElementById('adminList');
            tbody.innerHTML = '';
            document.getElementById('bookCount').innerText = books.length;

            const list = [...books].sort((a,b) => b.id - a.id);
            list.forEach(b => {
                let statusText = b.status === 'published' ? '<span style="color:#9acd32">出版</span>' : (b.status === 'completed' ? '完結' : '連載');
                tbody.innerHTML += `
                    <tr style="border-bottom:1px solid #444;">
                        <td style="padding:10px;">${b.id}</td>
                        <td style="padding:10px;">${b.title} <br><span style="font-size:12px;color:#888">${b.author}</span></td>
                        <td style="padding:10px;">${statusText}</td>
                        <td style="padding:10px; text-align:right;">
                            <button class="btn-small" style="background:var(--theme-yellow);color:#000;" onclick="editBook(${b.id})">編輯</button>
                            <button class="btn-small" style="background:#ff4500;color:#fff;" onclick="delBook(${b.id})">刪除</button>
                        </td>
                    </tr>
                `;
            });
        }

        function resetForm() {
            document.getElementById('editId').value = '';
            document.getElementById('inTitle').value = '';
            document.getElementById('inTags').value = '';
            document.getElementById('inCover').value = '';
            document.getElementById('inDesc').value = '';
            document.getElementById('inPrice').value = '';
            document.getElementById('inBuy').value = '';
            document.getElementById('inInfo').value = '';
            document.getElementById('inCarousel').checked = false;
            document.getElementById('inNews').value = '';
            togglePubFields();
        }

        function editBook(id) {
            const b = books.find(x => x.id === id);
            if(!b) return;
            document.getElementById('editId').value = b.id;
            document.getElementById('inTitle').value = b.title;
            document.getElementById('inAuthor').value = b.author;
            document.getElementById('inStatus').value = b.status;
            document.getElementById('inTags').value = b.tags;
            document.getElementById('inCover').value = b.cover;
            document.getElementById('inDesc').value = b.desc; // 這裡用 innerHTML 會更好，但 value 也行
            
            if(b.status === 'published') {
                document.getElementById('inPrice').value = b.price;
                document.getElementById('inColor').value = b.category;
                document.getElementById('inBuy').value = b.buyLink;
                document.getElementById('inInfo').value = b.infoLink;
                document.getElementById('inCarousel').checked = b.carousel;
            }
            togglePubFields();
        }

        function saveBook() {
            const id = document.getElementById('editId').value;
            const title = document.getElementById('inTitle').value;
            if(!title) return alert("請輸入書名");

            // 更新跑馬燈
            const news = document.getElementById('inNews').value;
            if(news) {
                newsText = news;
                localStorage.setItem('glory_news', newsText);
            }

            const newBook = {
                id: id ? parseInt(id) : Date.now(), // 新書用時間戳做ID確保最新
                title: title,
                author: document.getElementById('inAuthor').value,
                status: document.getElementById('inStatus').value,
                tags: document.getElementById('inTags').value,
                desc: document.getElementById('inDesc').value,
                cover: document.getElementById('inCover').value,
                // 出版欄位
                price: document.getElementById('inPrice').value,
                category: document.getElementById('inColor').value,
                buyLink: document.getElementById('inBuy').value,
                infoLink: document.getElementById('inInfo').value,
                carousel: document.getElementById('inCarousel').checked
            };

            if(id) {
                const idx = books.findIndex(x => x.id == id);
                books[idx] = newBook;
            } else {
                books.push(newBook);
            }

            localStorage.setItem('glory_books', JSON.stringify(books));
            alert("儲存成功");
            resetForm();
            renderAdminList();
        }

        function delBook(id) {
            if(confirm("確定刪除?")) {
                books = books.filter(x => x.id !== id);
                localStorage.setItem('glory_books', JSON.stringify(books));
                renderAdminList();
            }
        }

        // --- 啟動 ---
        renderHome();

    </script>
</body>
</html>
